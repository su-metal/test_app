# フォルダ構成と依存関係（現状）

このドキュメントは、現行リポジトリのモノレポ構成（pnpm Workspaces）と主要依存関係を簡潔にまとめたものです。実装や命名はプロジェクト エージェント ガイド／要件書に準拠しています。

## ルート構成

- `apps/`
  - `store/` 店側アプリ（Next.js App Router）。`3001` で開発起動。
  - `user/` ユーザー側アプリ（Next.js App Router）。`3002` で開発起動。
- `packages/`
  - `shared/` 共有ユーティリティ（現状プレースホルダ）。
- `docs/` ドキュメント（本ファイル含む）。
- `document/` 仕様・構成の詳細メモ（要件書等）。
- `scripts/` 開発補助スクリプト（例: 位置情報シード）。
- `supabase/` Supabase 設定やノート（存在する場合）。
- ルート設定ファイル
  - `package.json`（ワークスペース、共通依存、ルートスクリプト）
  - `pnpm-workspace.yaml`（ワークスペース宣言）
  - `pnpm-lock.yaml` / `package-lock.json`（ロック）
  - `.env.local`（必要に応じてルートで利用）

## ルート `package.json`

- Workspaces: `apps/*`, `packages/*`
- Scripts
  - `pnpm dev`: `apps/store` と `apps/user` を同時起動
  - `pnpm dev:store`: 店側のみ起動
  - `pnpm dev:user`: ユーザー側のみ起動
  - `pnpm seed:stores:locations`: 店舗の緯度経度をダミーで付与（`scripts/seed-stores-locations.mjs`）
- Dependencies（ルート）
  - `@supabase/supabase-js` `^2.74.0`（両アプリから利用）
  - `leaflet` `^1.9.4`（地図系ライブラリ、user 側でも使用）
- DevDependencies（ルート）
  - TypeScript/Tailwind/PostCSS 系: `typescript` `^5.9.3`, `tailwindcss` `^4.1.14`, `postcss` `^8.5.6`, `autoprefixer` `^10.4.21`
  - 型: `@types/react` `^19.2.2`, `@types/react-dom` `^19.2.1`
  - ユーティリティ: `concurrently` `^9.2.1`

## アプリ: `apps/store`

- スクリプト
  - `dev`: `next dev -p 3001`
  - `build`: `next build`
  - `start`: `next start`
- 依存関係（アプリ単位）
  - `next` `15.5.4`
  - `react` `19.1.0`, `react-dom` `19.1.0`
- 開発依存
  - `eslint` `^9`, `eslint-config-next` `15.5.4`
  - `@types/node` `^20`, `@types/react`, `@types/react-dom`
  - `tailwindcss` `^4`, `@tailwindcss/postcss`, `postcss`, `autoprefixer`
- 主なディレクトリ
  - `src/app/` App Router ルート（`layout.tsx`, `page.tsx`, `analytics/` 等）
  - `src/lib/` ストレージほかクライアントユーティリティ（例: `lib/storage/upload.ts`）
  - `src/types/` 型補助（例: `types/window.d.ts`）
  - `src/photo/` 画像など（開発用アセット）

## アプリ: `apps/user`

- スクリプト
  - `dev`: `next dev -p 3002`
  - `build`: `next build`
  - `start`: `next start`
- 依存関係（アプリ単位）
  - `next` `15.5.4`
  - `react` `19.1.0`, `react-dom` `19.1.0`
  - `leaflet` `^1.9.4`, `react-leaflet` `^5.0.0`
- 開発依存
  - `eslint` `^9`, `eslint-config-next` `15.5.4`
  - `@types/node` `^20`, `@types/react`, `@types/react-dom`
  - `tailwindcss` `^4`, `@tailwindcss/postcss`, `postcss`, `autoprefixer`
- 主なディレクトリ
  - `src/app/` App Router ルート（`layout.tsx`, `page.tsx`）
  - `src/components/` UI コンポーネント（例: `MapView.tsx`, `PickupTimeSelector.tsx`）
  - `src/lib/` クライアントユーティリティ（例: `supabase.ts`, `pickupSlots.ts`）

## パッケージ: `packages/shared`

- 目的: 両アプリで共有可能なユーティリティ配置先（現状は空に近い）
- メモ: 共有化する場合は TS パスエイリアスとビルド設定の整合を取ること

## スクリプト: `scripts/`

- `seed-stores-locations.mjs`
  - 概要: `stores.lat/lng` を指定中心から半径 ~5km で擬似付与
  - 依存: ルートの `@supabase/supabase-js`
  - 使い方: `pnpm seed:stores:locations`

## 備考

- パッケージマネージャ: pnpm（workspaces 有効）
- Next.js: App Router 構成、React 19 系
- Supabase クライアントはルート依存に置き、両アプリから利用
- Tailwind CSS 4 系をルート管理（各アプリで利用）

（本ファイルは現状スナップショットです。依存更新やフォルダ追加時は本ドキュメントを適宜更新してください）

